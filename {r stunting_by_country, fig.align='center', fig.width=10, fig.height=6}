# Filter data for stunting indicator
stunting_data <- combined_data %>%
  filter(grepl("Height-for-age", indicator)) %>%
  group_by(country) %>%
  summarize(avg_stunting = mean(obs_value, na.rm = TRUE)) %>%
  arrange(desc(avg_stunting)) %>%
  top_n(10)

# Create bar chart for stunting by country
stunting_country_chart <- ggplot(stunting_data, aes(x = avg_stunting, y = reorder(country, avg_stunting))) +
  geom_bar(stat = "identity", fill = "#e67e22") +
  geom_text(aes(label = sprintf("%.1f%%", avg_stunting)), hjust = -0.2, size = 4) +
  labs(title = "Top 10 Countries with Highest Child Stunting Rates",
       subtitle = "Average percentage of children with height-for-age below -2SD",
       x = "Stunting Rate (%)", 
       y = NULL,
       caption = "Source: UNICEF Global Database") +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 16),
    axis.text.y = element_text(size = 12),
    axis.title.x = element_text(size = 12),
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank()
  ) +
  coord_cartesian(clip = 'off') +
  scale_x_continuous(expand = expansion(mult = c(0, 0.2)), limits = c(0, max(stunting_data$avg_stunting) * 1.25))

print(stunting_country_chart) 